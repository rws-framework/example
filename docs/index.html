<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RWS Documentation</title>
    <!-- Docsearch -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>
    <!-- Prism Theme -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ea2845;
            --secondary-color: #1a1b1e;
            --text-color: #2c3e50;
            --bg-color: #ffffff;
            --sidebar-bg: #f8f9fa;
            --code-bg: #282c34;
            --border-color: #e2e8f0;
            --heading-color: #2d3748;
            --link-color: #ea2845;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.7;
            color: var(--text-color);
            background: var(--bg-color);
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        #sidebar {
            width: 300px;
            background: var(--sidebar-bg);
            padding: 2rem;
            height: 100vh;
            position: fixed;
            overflow-y: auto;
            border-right: 1px solid var(--border-color);
        }
        
        #content {
            margin-left: 300px;
            padding: 2rem 4rem;
            flex: 1;
            max-width: 1200px;
            line-height: 1.8;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .nav-section {
            margin-bottom: 1.5rem;
        }
        
        .nav-section-title {
            font-weight: 600;
            color: var(--secondary-color);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .nav-items {
            list-style: none;
            padding-left: 0.5rem;
        }
        
        .nav-item {
            padding: 0.4rem 0;
            cursor: pointer;
            color: var(--text-color);
            font-size: 0.95rem;
            transition: color 0.2s;
        }
        
        .nav-item:hover {
            color: var(--primary-color);
        }
        
        .nav-item.active {
            color: var(--primary-color);
            font-weight: 500;
        }
        
        h1, h2, h3, h4 {
            color: var(--heading-color);
            margin: 2rem 0 1rem;
            font-weight: 600;
            line-height: 1.3;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-top: 0;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        h2 {
            font-size: 1.75rem;
            margin-top: 3rem;
        }
        
        h3 {
            font-size: 1.35rem;
            margin-top: 2rem;
        }
        
        p {
            margin: 1rem 0;
        }
        
        a {
            color: var(--link-color);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
        }
        
        code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
            padding: 0.2em 0.4em;
            background: var(--sidebar-bg);
            border-radius: 0.25rem;
        }
        
        pre code {
            background: none;
            padding: 0;
        }
        
        ul {
            padding-left: 1.5rem;
            margin: 1rem 0;
        }
        
        .search-container {
            margin-bottom: 2rem;
        }
        
        #search {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            font-size: 0.95rem;
            transition: border-color 0.2s;
        }
        
        #search:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .warning {
            background: #fff5f5;
            border-left: 4px solid #fc8181;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.25rem;
        }
        
        .note {
            background: #ebf8ff;
            border-left: 4px solid #4299e1;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.25rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="sidebar">
            <div class="logo">
                <span>RWS Framework</span>
            </div>
            <div class="search-container">
                <input type="text" id="search" placeholder="Search documentation...">
            </div>
            <nav id="nav"></nav>
        </div>
        <main id="content">
            <div id="documentation"></div>
        </main>
    </div> 

    <div id="docs-content" style="display: none;">
        <div id="config">
            <h2>Config</h2>
            <p>in <code>src/config/config.ts</code> setup:</p>
            <pre><code class="language-typescript">
          import IAppConfig from "@rws-framework/server/src/types/IAppConfig";
          import { ConfigHelper } from "./ConfigHelper";
          import httpRoutes from '../routing/routes';
          import { resources } from '../app/resources';
          import { models } from '../models';
          
          export interface IAppModuleOpts extends IAppConfig { 
            jwt_expiration_days: number
          }
          
          const configHelper = new ConfigHelper();
          
          function config(): IAppModuleOpts {
              return {        
                  resources,
                  features: {
                      routing_enabled: true,
                      ws_enabled: true,
                      ssl: false,
                      auth: false
                  },
                  user_class: null,
                  user_models: models,
                  mongo_url: configHelper.get('DATABASE_URL'),
                  mongo_db: configHelper.get('MONGODB_DB'),
                  port: parseInt(configHelper.get('PORT')) || 3000,        
                  ws_port: parseInt(configHelper.get('WS_PORT')) || 3001,        
                  pub_dir: configHelper.get('PUBLIC_DIR'),
                  domain: configHelper.get('DOMAIN'),
                  cors_domain: '*',
                  secret_key: configHelper.get('JWT_SECRET'),    
                  jwt_expiration_days: parseInt(configHelper.get('JWT_EXPIRATION_DAYS')),
                  ssl_cert: null,
                  ssl_key: null,            
                  ws_routes: {},
                  http_routes: httpRoutes,
              };
          }
          
          export { config };
            </code></pre>
          </div>
          
          <div id="models">
            <h2>Models</h2>
            <p>RWS models are converted to Prisma schemas and are wrapping around generated PrismaClient providing complete typing and better Relation handling + TimeSeries in future minor versions.</p>
            
            <h3>Models Index File</h3>
            <pre><code class="language-typescript">
          import ApiKey from "./ApiKey";
          import User from "./User";
          
          export const models = [ User, ApiKey];
            </code></pre>
          
            <h3>Example User Model</h3>
            <pre><code class="language-typescript">
          import { RWSannotations, RWSModel } from '@rws-framework/server';
          import IUser from './interfaces/IUser';
          import 'reflect-metadata';
          
          class User extends RWSModel<User> implements IUser {
              @RWSTrackType(String)
              username: string;
          
              @RWSTrackType(String)
              passwd: string;
          
              @RWSTrackType(Boolean)
              active: boolean;
          
              @RWSTrackType(Date, { required: true })
              created_at: Date;
            
              static _collection = 'user';
          
              constructor(data?: IUser) {   
                  super(data);    
                  if(!this.created_at){
                      this.created_at = new Date();
                  }      
              }    
          }
          
          export default User;
            </code></pre>
          </div>
          
          <div id="routing">
            <h2>Backend Routing</h2>
            <p>RWS adds custom central file oriented (CFO) routing type to Nest.</p>
            
            <h3>Routes Configuration</h3>
            <pre><code class="language-typescript">
          import { RWSHTTPRoutingEntry } from '@rws-framework/server/src/routing/routes';
          import { homeRoutes } from './actions/homeActions';
          import { userRoutes } from './actions/userActions';
          
          export default [
              {
                  prefix: '/api',
                  controllerName: 'home',
                  routes: homeRoutes
              },
              {
                  prefix: '/api/users',
                  controllerName: 'user',
                  routes: userRoutes
              }
          ] as RWSHTTPRoutingEntry[];
            </code></pre>
          </div>
          
          <div id="cli">
            <h2>CLI</h2>
            <p>RWS provides powerful CLI tools for project management and custom commands.</p>
            
            <h3>Basic Commands</h3>
            <pre><code class="language-bash">
          # Initialize project
          yarn rws init
          
          # Add admin user
          yarn rws admin-add login pass
            </code></pre>
          </div>
          
          <div id="frontend">
            <h2>Frontend</h2>
            <p>Frontend is based on webcomponents templating system MS Fast v 1.* (v2 incoming)</p>
            
            <h3>Application Entry Point</h3>
            <pre><code class="language-typescript">
          import RWSClient, { RWSContainer, RWSPlugin } from '@rws-framework/client';
          import { RWSBrowserRouter } from '@rws-framework/browser-router';
          import { RWSWebsocketsPlugin } from '@rws-framework/nest-interconnectors';
          
          async function initializeApp() {
              const theClient = RWSContainer().get(RWSClient);      
              theClient.setNotifier(notifierMethod);
              theClient.addPlugin(RWSBrowserRouter);
              theClient.start({
                  backendRoutes,
                  backendUrl: process.env.BACKEND_URL,
                  wsUrl: process.env.WS_URL
              });
          }
          
          initializeApp().catch(console.error);
            </code></pre>
          </div>

          <div id="environment">
            <h2>Environment</h2>
            <p>First prepare .env file in root dir from:</p>
            <pre><code class="language-bash">.env.dist</code></pre>
        
            <p>Go to <strong>/docker</strong></p>
            <p><strong>setup .env for /docker</strong></p>
            <p>Best to link with main .env - env keys are same in app and for docker.</p>
            <pre><code class="language-bash">ln -s ../.env</code></pre>
        
            <p><strong>setup docker network</strong></p>
            <p>For precise networking (useful with more projects and X APIs under one docker-compose).</p>
            <p><em>sorry i use it as standard so it's here - deal with it</em></p>
            <pre><code class="language-bash">docker network create main</code></pre>
        </div>

        <div id="frontend_components">
            <h1>Frontend Components</h1>
            
            <p>RWS Framework provides a robust component system based on FAST web components. Components are the building blocks of your application's UI.</p>
            
            <h2>Basic Component Structure</h2>
            <p>A typical RWS component follows this structure:</p>
            
            <pre><code class="language-typescript">import { RWSViewComponent, RWSView } from '@rws-framework/client';
        
        @RWSView('custom-component')
        class CustomComponent extends RWSViewComponent {
            // Component properties
            @observable public title: string = '';
            
            // Lifecycle methods
            connectedCallback(): void {
                super.connectedCallback();
                // Initialization code
            }
        }
    
        CustomComponent.defineComponent()
    </code></pre>
            
            <h2>Component Decorators</h2>
            <table>
                <tr>
                    <th>Decorator</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>@RWSView</td>
                    <td>Defines a web component with a custom tag name</td>
                </tr>
                <tr>
                    <td>@observable</td>
                    <td>Makes a property reactive and updates the view when changed</td>
                </tr>
                <tr>
                    <td>@attr</td>
                    <td>Defines an HTML attribute that can be set on the component</td>
                </tr>
            </table>
            
            <h2>Lifecycle Methods</h2>
            <pre><code class="language-typescript">@RWSView('lifecycle-example')
        class LifecycleComponent extends RWSViewComponent {
            connectedCallback(): void {
                super.connectedCallback();
                console.log('Component connected to DOM');
            }
            
            disconnectedCallback(): void {
                super.disconnectedCallback();
                console.log('Component removed from DOM');
            }
            
            adoptedCallback(): void {
                console.log('Component moved to new document');
            }
            
            attributeChangedCallback(name: string, oldValue: string, newValue: string): void {
                console.log(`Attribute ${name} changed from ${oldValue} to ${newValue}`);
            }
        }</code></pre>
            
            <h2>Event Handling</h2>
            <pre><code class="language-typescript">@RWSView('event-example')
            class EventComponent extends RWSViewComponent {
                private handleClick() {
                    this.$emit('custom-event', { detail: 'Event data' });
                }                    
            }

            class ListenEventComponent extends RWSViewComponent {
                private handleClick() {
                    this.on('custom-event', (event) => {
                        console.log(event.detail);
                    });
                }                    
            }
    </code></pre>
            
            <h2>Templating Directives</h2>
            <p>RWS components use FAST templating system with T prefix directives:</p>
            compontent templates are in <u>template.html</u>
            <pre><code class="language-html">
                &lt;div&gt;
                    ${T.when(this.isVisible, T.html`
                        &lt;p&gt;Visible content&lt;/p&gt;
                    `)}
                    
                    <!-- Loops -->
                    ${T.repeat(this.items, (item) => T.html`
                        &lt;div&gt;\${item.name}&lt;/div&gt;
                    `)}
                    
                    <!-- Two-way binding -->
                    &lt;input type="text" :value="${x => x.value}" 
                           @input="${(x, c) => x.setValue(c.event)}"/&gt;
                &lt;/div&gt;
            </code></pre>
            
            <div class="note">
                <strong>Best Practice:</strong> Always extend RWSViewComponent for consistent behavior and lifecycle management.
            </div>
            
            <h2>Styling Components</h2>
           
            compontents are styled in <u>styles/layout.scss</u>
        </div>

        <div id="frontend_overview">
            <h1>Frontend Overview</h1>
            
            <p>The RWS Framework frontend is built on modern web technologies and provides a robust architecture for building scalable web applications.</p>
            
            <h2>Core Features</h2>
            <ul>
                <li>Based on MS Fast v1.* web components system (v2 coming soon)</li>
                <li>Built-in routing system</li>
                <li>WebSocket integration</li>
                <li>Dependency injection container</li>
            </ul>
            
            <h2>Basic Setup</h2>
            <p>Here's how to set up the basic application entry point:</p>
            
            <pre><code class="language-typescript">import RWSClient, { RWSContainer, RWSPlugin } from '@rws-framework/client';
        import { RWSBrowserRouter } from '@rws-framework/browser-router';
        import { RWSWebsocketsPlugin } from '@rws-framework/nest-interconnectors';
        
        async function initializeApp() {
            const theClient = RWSContainer().get(RWSClient);      
            theClient.setNotifier(notifierMethod);
            theClient.addPlugin(RWSBrowserRouter);
            theClient.start({
                backendRoutes,
                backendUrl: process.env.BACKEND_URL,
                wsUrl: process.env.WS_URL
            });
        }
        
        initializeApp().catch(console.error);</code></pre>
            
            <h2>Components</h2>
            <p>RWS components use FAST directives with T prefix for templating. Here's an example component:</p>
            
            <pre><code class="language-typescript">import { RWSViewComponent, RWSView } from '@rws-framework/client';
        
        @RWSView('rws-modal')
        class RWSModal extends RWSViewComponent {      
            connectedCallback(): void {
                super.connectedCallback();        
            }
        }
        
        RWSModal.defineComponent();</code></pre>
            
            <div class="note">
                <strong>Note:</strong> The framework is actively being developed, with version 2 of the FAST integration coming soon.
            </div>
            
            <h2>Environment Configuration</h2>
            <p>The frontend requires the following environment variables:</p>
            <ul>
                <li><code>BACKEND_URL</code>: URL of the backend API</li>
                <li><code>WS_URL</code>: WebSocket server URL</li>
            </ul>
        </div>

        <div id="introduction">
            <h1>RWS Fullstack Implementation Example Project</h1>
            <p>A comprehensive fullstack framework combining NestJS, FAST, and modern development tools.</p>
        </div>

        <div id="models">
            <h2>Models</h2>
            <p>RWS models are built on top of Prisma, providing enhanced functionality for data management and type safety.</p>
          
            <h3>Model Definition</h3>
            <pre><code class="language-typescript">import { RWSannotations, RWSModel } from '@rws-framework/server';
          import { IUser } from './interfaces/IUser';
          import 'reflect-metadata';
          
          @RWSannotations.model({
            name: 'User',
            collection: 'users'
          })
          class User extends RWSModel&lt;User&gt; implements IUser {
            @RWSannotations.field({
                type: 'string',
                required: true,
                unique: true
            })
            email: string;
          
            @RWSannotations.field({
                type: 'string',
                required: true
            })
            password: string;
          
            @RWSannotations.field({
                type: 'string'
            })
            name?: string;
          }
          
          export default User;</code></pre>
          
            <h3>Model Registration</h3>
            <pre><code class="language-typescript">// src/models/index.ts
          import User from "./User";
          import ApiKey from "./ApiKey";
          
          export const models = [
            User,
            ApiKey
          ];</code></pre>
          
            <h3>Using Models</h3>
            <pre><code class="language-typescript">// Example of model usage in a service
          @RWSannotations.injectable()
          class UserService {
            async createUser(userData: Partial&lt;IUser&gt;) {
                const user = new User(userData);
                await user.save();
                return user;
            }
          
            async findUserByEmail(email: string) {
                return await User.findOne({ email });
            }
          }</code></pre>
          </div>

          <div id="routing">
            <h2>Routing</h2>
        <p>RWS Framework provides a powerful routing system that supports both HTTP and WebSocket routes.</p>
        
        <h3>HTTP Routes Configuration</h3>
        <pre><code class="language-typescript">// src/routing/routes.ts
        import { RWSRoute } from '@rws-framework/server';
        import { UserController } from '../controllers/UserController';
        
        const httpRoutes: RWSRoute[] = [
        {
            path: '/api/users',
            controller: UserController,
            methods: {
                get: 'list',
                post: 'create'
            }
        },
        {
            path: '/api/users/:id',
            controller: UserController,
            methods: {
                get: 'getOne',
                put: 'update',
                delete: 'remove'
            }
        }
        ];
        
        export default httpRoutes;</code></pre>
        
        <h3>Controller Implementation</h3>
        <pre><code class="language-typescript">import { RWSannotations, RWSController } from '@rws-framework/server';
        import { UserService } from '../services/UserService';
        
        @RWSannotations.controller({
        path: '/api/users'
        })
        export class UserController extends RWSController {
        constructor(
            private userService: UserService
        ) {
            super();
        }
        
        @RWSannotations.route({
            method: 'GET'
        })
        async list(req: RWSRequest, res: RWSResponse) {
            const users = await this.userService.findAll();
            return res.json(users);
        }
        
        @RWSannotations.route({
            method: 'POST'
        })
        async create(req: RWSRequest, res: RWSResponse) {
            const user = await this.userService.createUser(req.body);
            return res.json(user);
        }
        }</code></pre>
        
        <h3>WebSocket Routes</h3>
        <pre><code class="language-typescript">// src/config/config.ts
        const wsRoutes = {
        'user:update': {
            controller: UserController,
            method: 'handleUserUpdate'
        },
        'chat:message': {
            controller: ChatController,
            method: 'handleMessage'
        }
        };
        
        export const config: IAppConfig = {
        // ... other config
        ws_routes: wsRoutes
        };</code></pre>
        
        <h3>Middleware Support</h3>
        <pre><code class="language-typescript">@RWSannotations.middleware({
        type: 'before'
        })
        export class AuthMiddleware implements RWSMiddleware {
        async handle(req: RWSRequest, res: RWSResponse, next: Function) {
            const token = req.headers['authorization'];
            if (!token) {
                return res.status(401).json({ error: 'Unauthorized' });
            }
            // Validate token
            await next();
        }
        }
        
        // Using middleware in routes
        const httpRoutes: RWSRoute[] = [
        {
            path: '/api/protected',
            controller: ProtectedController,
            middleware: [AuthMiddleware],
            methods: {
                get: 'getProtectedData'
            }
        }
        ];</code></pre>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script>       
        // Documentation structure
        const docs = {
            'Getting Started': {
                'Introduction': 'introduction',
                'Environment': 'environment',
                'Configuration': 'config'
            },
            'Core Concepts': {
                'Models': 'models',
                'Routing': 'routing',
                'CLI': 'cli'
            },
            'Frontend': {
                'Overview': 'frontend_overview',
                'Components': 'frontend_components'
            }
        };

        function getDoc(filename) {
            console.log('Reading #'+filename);
            return document.getElementById(filename).innerHTML;
        }

        
        // Generate navigation
        function generateNavigation() {
            const nav = document.getElementById('nav');
            Object.entries(docs).forEach(([section, items]) => {
                const sectionEl = document.createElement('div');
                sectionEl.className = 'nav-section';
                sectionEl.innerHTML = `
                    <h3 class="nav-section-title">${section}</h3>
                    <ul class="nav-items">
                        ${Object.keys(items).map(item => `
                            <li class="nav-item" data-section="${section}" data-item="${item}">
                                ${item}
                            </li>
                        `).join('')}
                    </ul>
                `;
                nav.appendChild(sectionEl);
            });
        }
        
        // Handle navigation clicks
        document.addEventListener('click', async (e) => {
            if (e.target.classList.contains('nav-item')) {
                const section = e.target.dataset.section;
                const item = e.target.dataset.item;
                
                // Update active state
                document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
                e.target.classList.add('active');
                
                console.log({item, section, docs});

                // Update content
                document.getElementById('documentation').innerHTML = await getDoc(docs[section][item]);
                
                // Highlight code blocks
                Prism.highlightAll();
            }
        });
        
        // Search functionality
        document.getElementById('search').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            document.querySelectorAll('.nav-item').forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        });
        
        // Initialize
        generateNavigation();
        
        // Load first section by default
        const firstSection = Object.keys(docs)[0];
        const firstItem = Object.keys(docs[firstSection])[0];
        document.getElementById('documentation').innerHTML = getDoc(docs[firstSection][firstItem]);
        document.querySelector('.nav-item').classList.add('active');
        
        // Initialize syntax highlighting
        Prism.highlightAll();
    </script>
</body>
</html>